class BadPollSDK {
  constructor() {
    this.frontUrl = 'https://poll.badfoxmc.com/sdk'
  }
  stop() {
    ;(this.iFrame = this.iFrameWrapper.removeChild(this.iFrame)),
      (this.iFrameWrapper = document.body.removeChild(this.iFrameWrapper))
  }
  start({ creatorStakeKey: e, voterStakeKey: t } = {}) {
    if (!document || !document.body) throw Error('document.body is not defined')
    if (!e || !t)
      throw Error(
        '400 BAD REQUEST; new BadPollSDK().start({ creatorStakeKey: "stake1...", voterStakeKey: "stake1..." })'
      )
    let r = `?creator_stake_key=${e}&voter_stake_key=${t}`,
      i = this.frontUrl + r,
      a = window.innerWidth <= 768
    ;(this.iFrameWrapper = document.createElement('div')),
      this.iFrameWrapper.setAttribute('id', 'bad-poll-iframe-wrapper'),
      this.iFrameWrapper.setAttribute(
        'style',
        'width: 100vw; height: 100vh; background-color: rgba(0, 0, 0, 0.5); border: none; display: flex; align-items: center; justify-content: center; position: fixed; top: 0; left: 0; z-index: 999999'
      ),
      (this.iFrame = document.createElement('iframe')),
      this.iFrame.setAttribute('id', 'bad-poll-iframe'),
      this.iFrame.setAttribute('src', i),
      this.iFrame.setAttribute(
        'style',
        `max-width: ${a ? '100vw' : '555px'}; width: 100%; max-height: ${
          a ? '100vh' : '70vh'
        }; height: 100%; border: none; border-radius: ${a ? '0' : '1rem'}; box-shadow: 0 0 2px #fff;`
      ),
      (this.iFrame = this.iFrameWrapper.appendChild(this.iFrame)),
      (this.iFrameWrapper = document.body.appendChild(this.iFrameWrapper)),
      window.addEventListener('message', ({ origin: e, data: t }) => {
        'bad-poll-close' === t && this.stop()
      })
  }
}
